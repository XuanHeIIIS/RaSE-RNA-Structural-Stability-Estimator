# RaSE
RaSE - RNA structurAl Stability Estimator

<p align="center"><img src="img/trna.png"></p>

## Library
RaSE exposes several functions that can be used inside other projects. See examples of use in the 
 [Jupyter notebook](https://github.com/fabriziocosta/RaSE/blob/master/RNAStructuralStabilityEstimator.ipynb)

## Usage

```
echo 'GCGGAAGUAGUUCAGUGGUAGAACACCACCUUGCCAAGGUGGGGGUCGCGGGUUCGAAUCCCGUCUUCCGCU' | ./code/RaSE.py --draw | tee out.txt && open out.pdf
             (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
  0 G A 0.93 .((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))..
  1 C A 0.16 ..(((((..((((.......)))).(((((((...))))))).....(((((.......))))))))))... *
  2 G C 0.13 .........((...(((((.....)))))...))...((((((((..(((((.......))))))))))))) *
  3 G A 0.17 .........((...(((((.....)))))...))...((((((((..(((((.......))))))))))))) *
  4 A U 0.20 ((((.((..((((.......)))).(((((((...))))))).....(((((.......))))))).)))).
  5 A U 0.69 (((((.(..((((.......)))).(((((((...))))))).....(((((.......)))))).))))).
  6 G C 0.61 ((((((...((((.......)))).(((((((...))))))).....(((((.......))))).)))))).
  7 U A 0.56 ((((((((.((((.......)))).(((((((...)))))))......((((.......)))))))))))).
  8 A G 0.48 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
  9 G A 0.60 (((((((.............((...(((((((...)))))))...))(((((.......)))))))))))).
 10 U A 0.56 (((((((.............((...(((((((...)))))))...))(((((.......)))))))))))).
 11 U C 0.71 (((((((....((...))..((...(((((((...)))))))...))(((((.......)))))))))))).
 12 C A 0.60 (((((((.............((...(((((((...)))))))...))(((((.......)))))))))))).
 13 A C 0.36 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 14 G C 0.60 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 15 U G 0.53 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 16 G U 0.82 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 17 G C 0.69 (((((((((((.....))))((...(((((((...)))))))...))(((((.......)))))))))))).
 18 U A 0.79 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 19 A G 0.55 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 20 G A 0.55 (((((((.......(((......)))..((((((....))))))...(((((.......)))))))))))).
 21 A U 0.62 (((((((.............(..(.(((((((...))))))).)..)(((((.......)))))))))))).
 22 A U 0.70 (((((((.............((((.(((((((...))))))).))))(((((.......)))))))))))).
 23 C G 0.56 (((((((.............((...(((((((...)))))))...))(((((.......)))))))))))).
 24 A C 0.68 (((((((.............((.(((((((((...))))))))).))(((((.......)))))))))))).
 25 C G 0.47 (((((((..((((.......)))).((.((((((....)))))))).(((((.......)))))))))))).
 26 C G 0.53 (((((((..((((.......)))).((((((..(((...)))))))))((((.......)))).))))))).
 27 A C 0.63 (((((((..((((.......))))((((((..((....)))))))).(((((.......)))))))))))).
 28 C A 0.56 (((((((..((((.......))))(((..(((((....)))))))).(((((.......)))))))))))).
 29 C G 0.47 (((((((.......(((((.....)))))...(((........))).(((((.......)))))))))))).
 30 U C 0.58 (((((((.......(((......)))..((((((....))))))...(((((.......)))))))))))).
 31 U C 0.55 (((((((.......(((......)))..((((((....))))))...(((((.......)))))))))))).
 32 G C 0.60 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 33 C A 0.95 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 34 C U 0.94 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 35 A C 0.55 (((((((.......(((((.....)))))...((((......)))).(((((.......)))))))))))).
 36 A C 0.57 (((((((..((((.......)))).(((((.......))))).....(((((.......)))))))))))).
 37 G U 0.57 (((((((.......(((((.....)))))...(((........))).(((((.......)))))))))))).
 38 G A 0.35 (((((....((...(((((.....)))))...))..((((((((.(((......))).))))))))))))).
 39 U G 0.55 (((((((.......(((......))).(((((.((...)).))))).(((((.......)))))))))))).
 40 G C 0.39 (((((((.......(((......))).(((((((....).)))))).(((((.......)))))))))))).
 41 G C 0.36 (((((((.......(((......)))((((((...))))))((((...((....))...)))).))))))).
 42 G C 0.59 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 43 G U 0.71 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 44 G U 0.72 (((((((.............((((.(((((((...))))))).))))(((((.......)))))))))))).
 45 U G 0.44 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 46 C G 0.57 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 47 G C 0.61 (((((((..((((.......)))).(((((((...)))))))......((((.......)))).))))))).
 48 C A 0.50 (((((((..((((.......)))).(((((((...)))))))(((((((....))))..)))..))))))).
 49 G U 0.49 (((((((..((((.......)))).(((((((...)))))))((((((......)))..)))..))))))).
 50 G C 0.50 (((((((..((((.......)))).(((((((...)))))))(((...((....))...)))..))))))).
 51 G U 0.50 (((((((..((((.......)))).(((((((...)))))))(((...((....))...)))..))))))).
 52 U C 0.56 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 53 U G 0.51 (((((((..((((.......)))).(((((((...)))))))(((((((....))))..)))..))))))).
 54 C U 0.80 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 55 G C 0.96 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 56 A G 0.52 (((((((.......(((......)))((((((...))))))((((((.((....))))))))..))))))).
 57 A C 0.41 (((((((..((...(((((.....)))))...)).....(((((((((......))))))))).))))))).
 58 U C 0.51 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 59 C G 0.60 (((((((..((((.......)))).(((((((...))))))).....((((.........))))))))))).
 60 C A 0.40 (((((((.......(((((.((((.((.((((((....)))))).....))))))..)))))..))))))).
 61 C U 0.52 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
 62 G A 0.43 (((((((..((((.......)))).(((((((...)))))))(((...((....))...)))..))))))).
 63 U A 0.54 ((((((((.((((.......)))).(((((((...)))))))......((((.......)))))))))))).
 64 C A 0.73 ((((((...((((.......)))).(((((((...))))))).....(((((.......))))).)))))).
 65 U C 0.17 (((((....((((.......)))).(((((((...))))))).((..(((((.......)))))))))))). *
 66 U C 0.19 ...(((....))).(((((.....)))))........((((((((..(((((.......))))))))))))) *
 67 C A 0.57 (((..((..((((.......)))).(((((((...))))))).....(((((.......)))))))..))).
 68 C G 0.73 ((.((((..((((.......)))).(((((((...))))))).....(((((.......))))))))).)).
 69 G A 0.15 ..(((((..((((.......)))).(((((((...))))))).....(((((.......))))))))))... *
 70 C A 0.93 .((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))..
 71 U A 0.96 (((((((..((((.......)))).(((((((...))))))).....(((((.......)))))))))))).
```

## Help

```
RaSE - RNA structurAl Stability Estimate.

Compute stability.

Version: 1.0
Author: Fabrizio Costa [costa@informatik.uni-freiburg.de]

Usage:
  RaSE [-i <sequence>]
       [-k N] [-c N, --complexity=N] [-n N, --nbits=N] [-w N, --window_size=N]
       [-b N, --max_bp_span=N] [-p N, --avg_bp_prob_cutoff=N]
       [-r N, --hard_threshold=N] [-e N, --max_num_edges=N]
       [-l, --no_lonely_bps] [-t, --no_nesting] [--draw]
       [--verbose]
  RaSE (-h | --help)
  RaSE --version

Options:
  -i <sequence>                     Specify input sequence [default: stdin].
  -k N                              Specify number of maximally unstable
                                    nucleotides to mark [default: 5].
  -c N, --complexity=N              Complexity of features [default: 3].
  -n N, --nbits=N                   Num bits to represent all possible feature
                                    pseudo identifiers [default: 15].
  -w N, --window_size=N             Window size [default: 150]
  -b N, --max_bp_span=N             Max number of spanning bases [default: 130]
  -p N, --avg_bp_prob_cutoff=N      Average probability cutoff [default: 0.1]
  -r N, --hard_threshold=N          Hard threshold [default: 0.5]
  -e N, --max_num_edges=N           Max num edges [default: 2]
  -l, --no_lonely_bps               Flag to activate no lonely base pairs mode.
  -t, --no_nesting                  Flag to activate no nesting mode.
  --draw                            Output drawing with standard name out.pdf.
  -h --help                         Show this screen.
  --version                         Show version.
  --verbose                         Print more text.
```
